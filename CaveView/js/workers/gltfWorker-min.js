!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e});for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var i={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]).toUpperCase()},clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*i.DEG2RAD},radToDeg:function(t){return t*i.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,i,r,n){var s=Math.cos,a=Math.sin,o=s(i/2),h=a(i/2),u=s((e+r)/2),c=a((e+r)/2),l=s((e-r)/2),p=a((e-r)/2),d=s((r-e)/2),m=a((r-e)/2);switch(n){case"XYX":t.set(o*c,h*l,h*p,o*u);break;case"YZY":t.set(h*p,o*c,h*l,o*u);break;case"ZXZ":t.set(h*l,h*p,o*c,o*u);break;case"XZX":t.set(o*c,h*m,h*d,o*u);break;case"YXY":t.set(h*d,o*c,h*m,o*u);break;case"ZYZ":t.set(h*m,h*d,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}};function r(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==r?r:1}Object.assign(r,{slerp:function(t,e,i,r){return i.copy(t).slerp(e,r)},slerpFlat:function(t,e,i,r,n,s,a){var o=i[r+0],h=i[r+1],u=i[r+2],c=i[r+3],l=n[s+0],p=n[s+1],d=n[s+2],m=n[s+3];if(c!==m||o!==l||h!==p||u!==d){var f=1-a,y=o*l+h*p+u*d+c*m,g=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){var v=Math.sqrt(x),b=Math.atan2(v,y*g);f=Math.sin(f*b)/v,a=Math.sin(a*b)/v}var w=a*g;if(o=o*f+l*w,h=h*f+p*w,u=u*f+d*w,c=c*f+m*w,f===1-a){var M=1/Math.sqrt(o*o+h*h+u*u+c*c);o*=M,h*=M,u*=M,c*=M}}t[e]=o,t[e+1]=h,t[e+2]=u,t[e+3]=c},multiplyQuaternionsFlat:function(t,e,i,r,n,s){var a=i[r],o=i[r+1],h=i[r+2],u=i[r+3],c=n[s],l=n[s+1],p=n[s+2],d=n[s+3];return t[e]=a*d+u*c+o*p-h*l,t[e+1]=o*d+u*l+h*c-a*p,t[e+2]=h*d+u*p+a*l-o*c,t[e+3]=u*d-a*c-o*l-h*p,t}}),Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(r.prototype,{isQuaternion:!0,set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,r=t._y,n=t._z,s=t.order,a=Math.cos,o=Math.sin,h=a(i/2),u=a(r/2),c=a(n/2),l=o(i/2),p=o(r/2),d=o(n/2);switch(s){case"XYZ":this._x=l*u*c+h*p*d,this._y=h*p*c-l*u*d,this._z=h*u*d+l*p*c,this._w=h*u*c-l*p*d;break;case"YXZ":this._x=l*u*c+h*p*d,this._y=h*p*c-l*u*d,this._z=h*u*d-l*p*c,this._w=h*u*c+l*p*d;break;case"ZXY":this._x=l*u*c-h*p*d,this._y=h*p*c+l*u*d,this._z=h*u*d+l*p*c,this._w=h*u*c-l*p*d;break;case"ZYX":this._x=l*u*c-h*p*d,this._y=h*p*c+l*u*d,this._z=h*u*d-l*p*c,this._w=h*u*c+l*p*d;break;case"YZX":this._x=l*u*c+h*p*d,this._y=h*p*c+l*u*d,this._z=h*u*d-l*p*c,this._w=h*u*c-l*p*d;break;case"XZY":this._x=l*u*c-h*p*d,this._y=h*p*c-l*u*d,this._z=h*u*d+l*p*c,this._w=h*u*c+l*p*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,r=i[0],n=i[4],s=i[8],a=i[1],o=i[5],h=i[9],u=i[2],c=i[6],l=i[10],p=r+o+l;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-h)*e,this._y=(s-u)*e,this._z=(a-n)*e):r>o&&r>l?(e=2*Math.sqrt(1+r-o-l),this._w=(c-h)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(s+u)/e):o>l?(e=2*Math.sqrt(1+o-r-l),this._w=(s-u)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(h+c)/e):(e=2*Math.sqrt(1+l-r-o),this._w=(a-n)/e,this._x=(s+u)/e,this._y=(h+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=t.dot(e)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(i.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var i=this.angleTo(t);if(0===i)return this;var r=Math.min(1,e/i);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,r=t._y,n=t._z,s=t._w,a=e._x,o=e._y,h=e._z,u=e._w;return this._x=i*u+s*a+r*h-n*o,this._y=r*u+s*o+n*a-i*h,this._z=n*u+s*h+i*o-r*a,this._w=s*u-i*a-r*o-n*h,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,r=this._y,n=this._z,s=this._w,a=s*t._w+i*t._x+r*t._y+n*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=i,this._y=r,this._z=n,this;var o=1-a*a;if(o<=Number.EPSILON){var h=1-e;return this._w=h*s+e*this._w,this._x=h*i+e*this._x,this._y=h*r+e*this._y,this._z=h*n+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(o),c=Math.atan2(u,a),l=Math.sin((1-e)*c)/u,p=Math.sin(e*c)/u;return this._w=s*l+this._w*p,this._x=i*l+this._x*p,this._y=r*l+this._y*p,this._z=n*l+this._z*p,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var n=new a,s=new r;function a(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function o(t,e){this.x=t||0,this.y=e||0}Object.assign(a.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(s.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(s.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6]*r,this.y=n[1]*e+n[4]*i+n[7]*r,this.z=n[2]*e+n[5]*i+n[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements,s=1/(n[3]*e+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*e+n[4]*i+n[8]*r+n[12])*s,this.y=(n[1]*e+n[5]*i+n[9]*r+n[13])*s,this.z=(n[2]*e+n[6]*i+n[10]*r+n[14])*s,this},applyQuaternion:function(t){var e=this.x,i=this.y,r=this.z,n=t.x,s=t.y,a=t.z,o=t.w,h=o*e+s*r-a*i,u=o*i+a*e-n*r,c=o*r+n*i-s*e,l=-n*e-s*i-a*r;return this.x=h*o+l*-n+u*-a-c*-s,this.y=u*o+l*-s+c*-n-h*-a,this.z=c*o+l*-a+h*-s-u*-n,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,i=this.y,r=this.z,n=t.elements;return this.x=n[0]*e+n[4]*i+n[8]*r,this.y=n[1]*e+n[5]*i+n[9]*r,this.z=n[2]*e+n[6]*i+n[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,r=t.y,n=t.z,s=e.x,a=e.y,o=e.z;return this.x=r*o-n*a,this.y=n*s-i*o,this.z=i*a-r*s,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)},projectOnPlane:function(t){return n.copy(this).projectOnVector(t),this.sub(n)},reflect:function(t){return this.sub(n.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var r=this.dot(t)/e;return Math.acos(i.clamp(r,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,i){var r=Math.sin(e)*t;return this.x=r*Math.sin(i),this.y=Math.cos(e)*t,this.z=r*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}),Object.defineProperties(o.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(o.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6],this.y=r[1]*e+r[4]*i+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,s=this.y-t.y;return this.x=n*i-s*r+t.x,this.y=n*r+s*i+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}});var h=[new a,new a,new a,new a,new a,new a,new a,new a],u=new a,c=new w,l=new a,p=new a,d=new a,m=new a,f=new a,y=new a,g=new a,x=new a,v=new a,b=new a;function w(t,e){this.min=void 0!==t?t:new a(1/0,1/0,1/0),this.max=void 0!==e?e:new a(-1/0,-1/0,-1/0)}function M(t,e,i,r,n){var s,a;for(s=0,a=t.length-3;s<=a;s+=3){b.fromArray(t,s);var o=n.x*Math.abs(b.x)+n.y*Math.abs(b.y)+n.z*Math.abs(b.z),h=e.dot(b),u=i.dot(b),c=r.dot(b);if(Math.max(-Math.max(h,u,c),Math.min(h,u,c))>o)return!1}return!0}Object.assign(w.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,a=-1/0,o=0,h=t.length;o<h;o+=3){var u=t[o],c=t[o+1],l=t[o+2];u<e&&(e=u),c<i&&(i=c),l<r&&(r=l),u>n&&(n=u),c>s&&(s=c),l>a&&(a=l)}return this.min.set(e,i,r),this.max.set(n,s,a),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,a=-1/0,o=0,h=t.count;o<h;o++){var u=t.getX(o),c=t.getY(o),l=t.getZ(o);u<e&&(e=u),c<i&&(i=c),l<r&&(r=l),u>n&&(n=u),c>s&&(s=c),l>a&&(a=l)}return this.min.set(e,i,r),this.max.set(n,s,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var i=u.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new a),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new a),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),c.copy(e.boundingBox),c.applyMatrix4(t.matrixWorld),this.union(c));for(var i=t.children,r=0,n=i.length;r<n;r++)this.expandByObject(i[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new a),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,u),u.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(g),x.subVectors(this.max,g),l.subVectors(t.a,g),p.subVectors(t.b,g),d.subVectors(t.c,g),m.subVectors(p,l),f.subVectors(d,p),y.subVectors(l,d);var e=[0,-m.z,m.y,0,-f.z,f.y,0,-y.z,y.y,m.z,0,-m.x,f.z,0,-f.x,y.z,0,-y.x,-m.y,m.x,0,-f.y,f.x,0,-y.y,y.x,0];return!!M(e,l,p,d,x)&&(!!M(e=[1,0,0,0,1,0,0,0,1],l,p,d,x)&&(v.crossVectors(m,f),M(e=[v.x,v.y,v.z],l,p,d,x)))},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new a),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return u.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(u).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(h[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),h[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),h[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),h[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),h[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),h[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),h[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),h[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(h)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var z=new w;function T(t,e){this.center=void 0!==t?t:new a,this.radius=void 0!==e?e:-1}Object.assign(T.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var i=this.center;void 0!==e?i.copy(e):z.setFromPoints(t).getCenter(i);for(var r=0,n=0,s=t.length;n<s;n++)r=Math.max(r,i.distanceToSquared(t[n]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new a),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new w),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var S=new a,_=new a,A=new a,E=new a,N=new a,O=new a,R=new a;function k(t,e){this.origin=void 0!==t?t:new a,this.direction=void 0!==e?e:new a(0,0,-1)}Object.assign(k.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new a),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,S)),this},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new a),e.subVectors(t,this.origin);var i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=S.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(S.copy(this.direction).multiplyScalar(e).add(this.origin),S.distanceToSquared(t))},distanceSqToSegment:function(t,e,i,r){_.copy(t).add(e).multiplyScalar(.5),A.copy(e).sub(t).normalize(),E.copy(this.origin).sub(_);var n,s,a,o,h=.5*t.distanceTo(e),u=-this.direction.dot(A),c=E.dot(this.direction),l=-E.dot(A),p=E.lengthSq(),d=Math.abs(1-u*u);if(d>0)if(s=u*c-l,o=h*d,(n=u*l-c)>=0)if(s>=-o)if(s<=o){var m=1/d;a=(n*=m)*(n+u*(s*=m)+2*c)+s*(u*n+s+2*l)+p}else s=h,a=-(n=Math.max(0,-(u*s+c)))*n+s*(s+2*l)+p;else s=-h,a=-(n=Math.max(0,-(u*s+c)))*n+s*(s+2*l)+p;else s<=-o?a=-(n=Math.max(0,-(-u*h+c)))*n+(s=n>0?-h:Math.min(Math.max(-h,-l),h))*(s+2*l)+p:s<=o?(n=0,a=(s=Math.min(Math.max(-h,-l),h))*(s+2*l)+p):a=-(n=Math.max(0,-(u*h+c)))*n+(s=n>0?h:Math.min(Math.max(-h,-l),h))*(s+2*l)+p;else s=u>0?-h:h,a=-(n=Math.max(0,-(u*s+c)))*n+s*(s+2*l)+p;return i&&i.copy(this.direction).multiplyScalar(n).add(this.origin),r&&r.copy(A).multiplyScalar(s).add(_),a},intersectSphere:function(t,e){S.subVectors(t.center,this.origin);var i=S.dot(this.direction),r=S.dot(S)-i*i,n=t.radius*t.radius;if(r>n)return null;var s=Math.sqrt(n-r),a=i-s,o=i+s;return a<0&&o<0?null:a<0?this.at(o,e):this.at(a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,r,n,s,a,o,h=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,l=this.origin;return h>=0?(i=(t.min.x-l.x)*h,r=(t.max.x-l.x)*h):(i=(t.max.x-l.x)*h,r=(t.min.x-l.x)*h),u>=0?(n=(t.min.y-l.y)*u,s=(t.max.y-l.y)*u):(n=(t.max.y-l.y)*u,s=(t.min.y-l.y)*u),i>s||n>r?null:((n>i||i!=i)&&(i=n),(s<r||r!=r)&&(r=s),c>=0?(a=(t.min.z-l.z)*c,o=(t.max.z-l.z)*c):(a=(t.max.z-l.z)*c,o=(t.min.z-l.z)*c),i>o||a>r?null:((a>i||i!=i)&&(i=a),(o<r||r!=r)&&(r=o),r<0?null:this.at(i>=0?i:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,S)},intersectTriangle:function(t,e,i,r,n){N.subVectors(e,t),O.subVectors(i,t),R.crossVectors(N,O);var s,a=this.direction.dot(R);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}E.subVectors(this.origin,t);var o=s*this.direction.dot(O.crossVectors(E,O));if(o<0)return null;var h=s*this.direction.dot(N.cross(E));if(h<0)return null;if(o+h>a)return null;var u=-s*E.dot(R);return u<0?null:this.at(u/a,n)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var B=new a,V=new L,F=new a(0,0,0),I=new a(1,1,1),C=new a,U=new a,P=new a;function L(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function j(){}Object.assign(L.prototype,{isMatrix4:!0,set:function(t,e,i,r,n,s,a,o,h,u,c,l,p,d,m,f){var y=this.elements;return y[0]=t,y[4]=e,y[8]=i,y[12]=r,y[1]=n,y[5]=s,y[9]=a,y[13]=o,y[2]=h,y[6]=u,y[10]=c,y[14]=l,y[3]=p,y[7]=d,y[11]=m,y[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new L).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,i=t.elements,r=1/B.setFromMatrixColumn(t,0).length(),n=1/B.setFromMatrixColumn(t,1).length(),s=1/B.setFromMatrixColumn(t,2).length();return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=0,e[4]=i[4]*n,e[5]=i[5]*n,e[6]=i[6]*n,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,r=t.y,n=t.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(r),h=Math.sin(r),u=Math.cos(n),c=Math.sin(n);if("XYZ"===t.order){var l=s*u,p=s*c,d=a*u,m=a*c;e[0]=o*u,e[4]=-o*c,e[8]=h,e[1]=p+d*h,e[5]=l-m*h,e[9]=-a*o,e[2]=m-l*h,e[6]=d+p*h,e[10]=s*o}else if("YXZ"===t.order){var f=o*u,y=o*c,g=h*u,x=h*c;e[0]=f+x*a,e[4]=g*a-y,e[8]=s*h,e[1]=s*c,e[5]=s*u,e[9]=-a,e[2]=y*a-g,e[6]=x+f*a,e[10]=s*o}else if("ZXY"===t.order){f=o*u,y=o*c,g=h*u,x=h*c;e[0]=f-x*a,e[4]=-s*c,e[8]=g+y*a,e[1]=y+g*a,e[5]=s*u,e[9]=x-f*a,e[2]=-s*h,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){l=s*u,p=s*c,d=a*u,m=a*c;e[0]=o*u,e[4]=d*h-p,e[8]=l*h+m,e[1]=o*c,e[5]=m*h+l,e[9]=p*h-d,e[2]=-h,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){var v=s*o,b=s*h,w=a*o,M=a*h;e[0]=o*u,e[4]=M-v*c,e[8]=w*c+b,e[1]=c,e[5]=s*u,e[9]=-a*u,e[2]=-h*u,e[6]=b*c+w,e[10]=v-M*c}else if("XZY"===t.order){v=s*o,b=s*h,w=a*o,M=a*h;e[0]=o*u,e[4]=-c,e[8]=h*u,e[1]=v*c+M,e[5]=s*u,e[9]=b*c-w,e[2]=w*c-b,e[6]=a*u,e[10]=M*c+v}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(F,t,I)},lookAt:function(t,e,i){var r=this.elements;return P.subVectors(t,e),0===P.lengthSq()&&(P.z=1),P.normalize(),C.crossVectors(i,P),0===C.lengthSq()&&(1===Math.abs(i.z)?P.x+=1e-4:P.z+=1e-4,P.normalize(),C.crossVectors(i,P)),C.normalize(),U.crossVectors(P,C),r[0]=C.x,r[4]=U.x,r[8]=P.x,r[1]=C.y,r[5]=U.y,r[9]=P.y,r[2]=C.z,r[6]=U.z,r[10]=P.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,s=i[0],a=i[4],o=i[8],h=i[12],u=i[1],c=i[5],l=i[9],p=i[13],d=i[2],m=i[6],f=i[10],y=i[14],g=i[3],x=i[7],v=i[11],b=i[15],w=r[0],M=r[4],z=r[8],T=r[12],S=r[1],_=r[5],A=r[9],E=r[13],N=r[2],O=r[6],R=r[10],k=r[14],B=r[3],V=r[7],F=r[11],I=r[15];return n[0]=s*w+a*S+o*N+h*B,n[4]=s*M+a*_+o*O+h*V,n[8]=s*z+a*A+o*R+h*F,n[12]=s*T+a*E+o*k+h*I,n[1]=u*w+c*S+l*N+p*B,n[5]=u*M+c*_+l*O+p*V,n[9]=u*z+c*A+l*R+p*F,n[13]=u*T+c*E+l*k+p*I,n[2]=d*w+m*S+f*N+y*B,n[6]=d*M+m*_+f*O+y*V,n[10]=d*z+m*A+f*R+y*F,n[14]=d*T+m*E+f*k+y*I,n[3]=g*w+x*S+v*N+b*B,n[7]=g*M+x*_+v*O+b*V,n[11]=g*z+x*A+v*R+b*F,n[15]=g*T+x*E+v*k+b*I,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[4],r=t[8],n=t[12],s=t[1],a=t[5],o=t[9],h=t[13],u=t[2],c=t[6],l=t[10],p=t[14];return t[3]*(+n*o*c-r*h*c-n*a*l+i*h*l+r*a*p-i*o*p)+t[7]*(+e*o*p-e*h*l+n*s*l-r*s*p+r*h*u-n*o*u)+t[11]*(+e*h*c-e*a*p-n*s*c+i*s*p+n*a*u-i*h*u)+t[15]*(-r*a*u-e*o*c+e*a*l+r*s*c-i*s*l+i*o*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,i){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=i),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var i=this.elements,r=t.elements,n=r[0],s=r[1],a=r[2],o=r[3],h=r[4],u=r[5],c=r[6],l=r[7],p=r[8],d=r[9],m=r[10],f=r[11],y=r[12],g=r[13],x=r[14],v=r[15],b=d*x*l-g*m*l+g*c*f-u*x*f-d*c*v+u*m*v,w=y*m*l-p*x*l-y*c*f+h*x*f+p*c*v-h*m*v,M=p*g*l-y*d*l+y*u*f-h*g*f-p*u*v+h*d*v,z=y*d*c-p*g*c-y*u*m+h*g*m+p*u*x-h*d*x,T=n*b+s*w+a*M+o*z;if(0===T)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var S=1/T;return i[0]=b*S,i[1]=(g*m*o-d*x*o-g*a*f+s*x*f+d*a*v-s*m*v)*S,i[2]=(u*x*o-g*c*o+g*a*l-s*x*l-u*a*v+s*c*v)*S,i[3]=(d*c*o-u*m*o-d*a*l+s*m*l+u*a*f-s*c*f)*S,i[4]=w*S,i[5]=(p*x*o-y*m*o+y*a*f-n*x*f-p*a*v+n*m*v)*S,i[6]=(y*c*o-h*x*o-y*a*l+n*x*l+h*a*v-n*c*v)*S,i[7]=(h*m*o-p*c*o+p*a*l-n*m*l-h*a*f+n*c*f)*S,i[8]=M*S,i[9]=(y*d*o-p*g*o-y*s*f+n*g*f+p*s*v-n*d*v)*S,i[10]=(h*g*o-y*u*o+y*s*l-n*g*l-h*s*v+n*u*v)*S,i[11]=(p*u*o-h*d*o-p*s*l+n*d*l+h*s*f-n*u*f)*S,i[12]=z*S,i[13]=(p*g*a-y*d*a+y*s*m-n*g*m-p*s*x+n*d*x)*S,i[14]=(y*u*a-h*g*a-y*s*c+n*g*c+h*s*x-n*u*x)*S,i[15]=(h*d*a-p*u*a+p*s*c-n*d*c-h*s*m+n*u*m)*S,this},scale:function(t){var e=this.elements,i=t.x,r=t.y,n=t.z;return e[0]*=i,e[4]*=r,e[8]*=n,e[1]*=i,e[5]*=r,e[9]*=n,e[2]*=i,e[6]*=r,e[10]*=n,e[3]*=i,e[7]*=r,e[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),r=Math.sin(e),n=1-i,s=t.x,a=t.y,o=t.z,h=n*s,u=n*a;return this.set(h*s+i,h*a-r*o,h*o+r*a,0,h*a+r*o,u*a+i,u*o-r*s,0,h*o-r*a,u*o+r*s,n*o*o+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){var r=this.elements,n=e._x,s=e._y,a=e._z,o=e._w,h=n+n,u=s+s,c=a+a,l=n*h,p=n*u,d=n*c,m=s*u,f=s*c,y=a*c,g=o*h,x=o*u,v=o*c,b=i.x,w=i.y,M=i.z;return r[0]=(1-(m+y))*b,r[1]=(p+v)*b,r[2]=(d-x)*b,r[3]=0,r[4]=(p-v)*w,r[5]=(1-(l+y))*w,r[6]=(f+g)*w,r[7]=0,r[8]=(d+x)*M,r[9]=(f-g)*M,r[10]=(1-(l+m))*M,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,i){var r=this.elements,n=B.set(r[0],r[1],r[2]).length(),s=B.set(r[4],r[5],r[6]).length(),a=B.set(r[8],r[9],r[10]).length();this.determinant()<0&&(n=-n),t.x=r[12],t.y=r[13],t.z=r[14],V.copy(this);var o=1/n,h=1/s,u=1/a;return V.elements[0]*=o,V.elements[1]*=o,V.elements[2]*=o,V.elements[4]*=h,V.elements[5]*=h,V.elements[6]*=h,V.elements[8]*=u,V.elements[9]*=u,V.elements[10]*=u,e.setFromRotationMatrix(V),i.x=n,i.y=s,i.z=a,this},makePerspective:function(t,e,i,r,n,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,o=2*n/(e-t),h=2*n/(i-r),u=(e+t)/(e-t),c=(i+r)/(i-r),l=-(s+n)/(s-n),p=-2*s*n/(s-n);return a[0]=o,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=l,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,i,r,n,s){var a=this.elements,o=1/(e-t),h=1/(i-r),u=1/(s-n),c=(e+t)*o,l=(i+r)*h,p=(s+n)*u;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-l,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,r=0;r<16;r++)if(e[r]!==i[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}),Object.assign(j.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var r=i.indexOf(e);-1!==r&&i.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=e.slice(0),r=0,n=i.length;r<n;r++)i[r].call(this,t)}}}});var H=new L,D=new r;function q(t,e,i,r){this._x=t||0,this._y=e||0,this._z=i||0,this._order=r||q.DefaultOrder}function G(){this.mask=1}function W(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}q.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],q.DefaultOrder="XYZ",Object.defineProperties(q.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(q.prototype,{isEuler:!0,set:function(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var n=i.clamp,s=t.elements,a=s[0],o=s[4],h=s[8],u=s[1],c=s[5],l=s[9],p=s[2],d=s[6],m=s[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(n(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-l,m),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(h,m),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-p,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-n(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(h,m));break;case"XZY":this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(h,a)):(this._x=Math.atan2(-l,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,i){return H.makeRotationFromQuaternion(t),this.setFromRotationMatrix(H,e,i)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return D.setFromEuler(this),this.setFromQuaternion(D,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new a(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(G.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(W.prototype,{isMatrix3:!0,set:function(t,e,i,r,n,s,a,o,h){var u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=n,u[5]=o,u[6]=i,u[7]=s,u[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},extractBasis:function(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,r=e.elements,n=this.elements,s=i[0],a=i[3],o=i[6],h=i[1],u=i[4],c=i[7],l=i[2],p=i[5],d=i[8],m=r[0],f=r[3],y=r[6],g=r[1],x=r[4],v=r[7],b=r[2],w=r[5],M=r[8];return n[0]=s*m+a*g+o*b,n[3]=s*f+a*x+o*w,n[6]=s*y+a*v+o*M,n[1]=h*m+u*g+c*b,n[4]=h*f+u*x+c*w,n[7]=h*y+u*v+c*M,n[2]=l*m+p*g+d*b,n[5]=l*f+p*x+d*w,n[8]=l*y+p*v+d*M,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=t[8];return e*s*u-e*a*h-i*n*u+i*a*o+r*n*h-r*s*o},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements,r=this.elements,n=i[0],s=i[1],a=i[2],o=i[3],h=i[4],u=i[5],c=i[6],l=i[7],p=i[8],d=p*h-u*l,m=u*c-p*o,f=l*o-h*c,y=n*d+s*m+a*f;if(0===y)return this.set(0,0,0,0,0,0,0,0,0);var g=1/y;return r[0]=d*g,r[1]=(a*l-p*s)*g,r[2]=(u*s-a*h)*g,r[3]=m*g,r[4]=(p*n-a*c)*g,r[5]=(a*o-u*n)*g,r[6]=f*g,r[7]=(s*c-l*n)*g,r[8]=(h*n-s*o)*g,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,r,n,s,a){var o=Math.cos(n),h=Math.sin(n);this.set(i*o,i*h,-i*(o*s+h*a)+s+t,-r*h,r*o,-r*(-h*s+o*a)+a+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=this.elements,n=r[0],s=r[3],a=r[6],o=r[1],h=r[4],u=r[7];return r[0]=e*n+i*o,r[3]=e*s+i*h,r[6]=e*a+i*u,r[1]=-i*n+e*o,r[4]=-i*s+e*h,r[7]=-i*a+e*u,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){for(var e=this.elements,i=t.elements,r=0;r<9;r++)if(e[r]!==i[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var Y=0,X=new a,Z=new r,J=new L,Q=new a,K=new a,$=new a,tt=new r,et=new a(1,0,0),it=new a(0,1,0),rt=new a(0,0,1),nt={type:"added"},st={type:"removed"};function at(){Object.defineProperty(this,"id",{value:Y++}),this.uuid=i.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=at.DefaultUp.clone();var t=new a,e=new q,n=new r,s=new a(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new L},normalMatrix:{value:new W}}),this.matrix=new L,this.matrixWorld=new L,this.matrixAutoUpdate=at.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new G,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}at.DefaultUp=new a(0,1,0),at.DefaultMatrixAutoUpdate=!0,at.prototype=Object.assign(Object.create(j.prototype),{constructor:at,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Z.setFromAxisAngle(t,e),this.quaternion.multiply(Z),this},rotateOnWorldAxis:function(t,e){return Z.setFromAxisAngle(t,e),this.quaternion.premultiply(Z),this},rotateX:function(t){return this.rotateOnAxis(et,t)},rotateY:function(t){return this.rotateOnAxis(it,t)},rotateZ:function(t){return this.rotateOnAxis(rt,t)},translateOnAxis:function(t,e){return X.copy(t).applyQuaternion(this.quaternion),this.position.add(X.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(et,t)},translateY:function(t){return this.translateOnAxis(it,t)},translateZ:function(t){return this.translateOnAxis(rt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(J.getInverse(this.matrixWorld))},lookAt:function(t,e,i){t.isVector3?Q.copy(t):Q.set(t,e,i);var r=this.parent;this.updateWorldMatrix(!0,!1),K.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?J.lookAt(K,Q,this.up):J.lookAt(Q,K,this.up),this.quaternion.setFromRotationMatrix(J),r&&(J.extractRotation(r.matrixWorld),Z.setFromRotationMatrix(J),this.quaternion.premultiply(Z.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(nt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(st)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),J.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),J.multiply(t.parent.matrixWorld)),t.applyMatrix4(J),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,r=this.children.length;i<r;i++){var n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new a),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new r),this.updateMatrixWorld(!0),this.matrixWorld.decompose(K,t,$),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(K,tt,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new a),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,r=e.length;i<r;i++)e[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,n=0,s=r.length;n<s;n++)r[n].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function n(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=n(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes){var a=s.shapes;if(Array.isArray(a))for(var o=0,h=a.length;o<h;o++){var u=a[o];n(t.shapes,u)}else n(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(o=0,h=this.material.length;o<h;o++)c.push(n(t.materials,this.material[o]));r.material=c}else r.material=n(t.materials,this.material);if(this.children.length>0){r.children=[];for(o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(e){var l=f(t.geometries),p=f(t.materials),d=f(t.textures),m=f(t.images);a=f(t.shapes);l.length>0&&(i.geometries=l),p.length>0&&(i.materials=p),d.length>0&&(i.textures=d),m.length>0&&(i.images=m),a.length>0&&(i.shapes=a)}return i.object=r,i;function f(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var r=t.children[i];this.add(r.clone())}return this}});var ot=new a,ht=new a,ut=new W;function ct(t,e){this.normal=void 0!==t?t:new a(1,0,0),this.constant=void 0!==e?e:0}Object.assign(ct.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,i){var r=ot.subVectors(i,e).cross(ht.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new a),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new a);var i=t.delta(ot),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var n=-(t.start.dot(this.normal)+this.constant)/r;return n<0||n>1?void 0:e.copy(i).multiplyScalar(n).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new a),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var i=e||ut.getNormalMatrix(t),r=this.coplanarPoint(ot).applyMatrix4(t),n=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(n),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var lt=new a,pt=new a,dt=new a,mt=new a,ft=new a,yt=new a,gt=new a,xt=new a,vt=new a,bt=new a;function wt(t,e,i){this.a=void 0!==t?t:new a,this.b=void 0!==e?e:new a,this.c=void 0!==i?i:new a}Object.assign(wt,{getNormal:function(t,e,i,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new a),r.subVectors(i,e),lt.subVectors(t,e),r.cross(lt);var n=r.lengthSq();return n>0?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)},getBarycoord:function(t,e,i,r,n){lt.subVectors(r,e),pt.subVectors(i,e),dt.subVectors(t,e);var s=lt.dot(lt),o=lt.dot(pt),h=lt.dot(dt),u=pt.dot(pt),c=pt.dot(dt),l=s*u-o*o;if(void 0===n&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),n=new a),0===l)return n.set(-2,-1,-1);var p=1/l,d=(u*h-o*c)*p,m=(s*c-o*h)*p;return n.set(1-d-m,m,d)},containsPoint:function(t,e,i,r){return wt.getBarycoord(t,e,i,r,mt),mt.x>=0&&mt.y>=0&&mt.x+mt.y<=1},getUV:function(t,e,i,r,n,s,a,o){return this.getBarycoord(t,e,i,r,mt),o.set(0,0),o.addScaledVector(n,mt.x),o.addScaledVector(s,mt.y),o.addScaledVector(a,mt.z),o},isFrontFacing:function(t,e,i,r){return lt.subVectors(i,e),pt.subVectors(t,e),lt.cross(pt).dot(r)<0}}),Object.assign(wt.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,r){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return lt.subVectors(this.c,this.b),pt.subVectors(this.a,this.b),.5*lt.cross(pt).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new a),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return wt.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new ct),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return wt.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,i,r,n){return wt.getUV(t,this.a,this.b,this.c,e,i,r,n)},containsPoint:function(t){return wt.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return wt.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new a);var i,r,n=this.a,s=this.b,o=this.c;ft.subVectors(s,n),yt.subVectors(o,n),xt.subVectors(t,n);var h=ft.dot(xt),u=yt.dot(xt);if(h<=0&&u<=0)return e.copy(n);vt.subVectors(t,s);var c=ft.dot(vt),l=yt.dot(vt);if(c>=0&&l<=c)return e.copy(s);var p=h*l-c*u;if(p<=0&&h>=0&&c<=0)return i=h/(h-c),e.copy(n).addScaledVector(ft,i);bt.subVectors(t,o);var d=ft.dot(bt),m=yt.dot(bt);if(m>=0&&d<=m)return e.copy(o);var f=d*u-h*m;if(f<=0&&u>=0&&m<=0)return r=u/(u-m),e.copy(n).addScaledVector(yt,r);var y=c*m-d*l;if(y<=0&&l-c>=0&&d-m>=0)return gt.subVectors(o,s),r=(l-c)/(l-c+(d-m)),e.copy(s).addScaledVector(gt,r);var g=1/(y+f+p);return i=f*g,r=p*g,e.copy(n).addScaledVector(ft,i).addScaledVector(yt,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zt={h:0,s:0,l:0},Tt={h:0,s:0,l:0};function St(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function _t(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function At(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Et(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Nt(t,e,i,r,n,s){this.a=t,this.b=e,this.c=i,this.normal=r&&r.isVector3?r:new a,this.vertexNormals=Array.isArray(r)?r:[],this.color=n&&n.isColor?n:new St,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==s?s:0}Object.assign(St.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,r){if(t=i.euclideanModulo(t,1),e=i.clamp(e,0,1),r=i.clamp(r,0,1),0===e)this.r=this.g=this.b=r;else{var n=r<=.5?r*(1+e):r+e-r*e,s=2*r-n;this.r=_t(s,n,t+1/3),this.g=_t(s,n,t),this.b=_t(s,n,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,n=i[1],s=i[2];switch(n){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){var a=parseFloat(r[1])/360,o=parseInt(r[2],10)/100,h=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,o,h)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=i[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=Mt[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=At(t.r),this.g=At(t.g),this.b=At(t.b),this},copyLinearToSRGB:function(t){return this.r=Et(t.r),this.g=Et(t.g),this.b=Et(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,i,r=this.r,n=this.g,s=this.b,a=Math.max(r,n,s),o=Math.min(r,n,s),h=(o+a)/2;if(o===a)e=0,i=0;else{var u=a-o;switch(i=h<=.5?u/(a+o):u/(2-a-o),a){case r:e=(n-s)/u+(n<s?6:0);break;case n:e=(s-r)/u+2;break;case s:e=(r-n)/u+4}e/=6}return t.h=e,t.s=i,t.l=h,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){return this.getHSL(zt),zt.h+=t,zt.s+=e,zt.l+=i,this.setHSL(zt.h,zt.s,zt.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(zt),t.getHSL(Tt);var r=i.lerp(zt.h,Tt.h,e),n=i.lerp(zt.s,Tt.s,e),s=i.lerp(zt.l,Tt.l,e);return this.setHSL(r,n,s),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),St.NAMES=Mt,Object.assign(Nt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Ot=0;function Rt(){Object.defineProperty(this,"id",{value:Ot++}),this.uuid=i.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function kt(t){Rt.call(this),this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}function Bt(t,e,i,r){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==r?r:1}Rt.prototype=Object.assign(Object.create(j.prototype),{constructor:Rt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var i in t){var r=t[i];delete r.metadata,e.push(r)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){var n=r(t.textures),s=r(t.images);n.length>0&&(i.textures=n),s.length>0&&(i.images=s)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,i=null;if(null!==e){var r=e.length;i=new Array(r);for(var n=0;n!==r;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Rt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),kt.prototype=Object.create(Rt.prototype),kt.prototype.constructor=kt,kt.prototype.isMeshBasicMaterial=!0,kt.prototype.copy=function(t){return Rt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Object.defineProperties(Bt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Bt.prototype,{isVector4:!0,set:function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,r=this.z,n=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*r+s[12]*n,this.y=s[1]*e+s[5]*i+s[9]*r+s[13]*n,this.z=s[2]*e+s[6]*i+s[10]*r+s[14]*n,this.w=s[3]*e+s[7]*i+s[11]*r+s[15]*n,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,r,n,s=t.elements,a=s[0],o=s[4],h=s[8],u=s[1],c=s[5],l=s[9],p=s[2],d=s[6],m=s[10];if(Math.abs(o-u)<.01&&Math.abs(h-p)<.01&&Math.abs(l-d)<.01){if(Math.abs(o+u)<.1&&Math.abs(h+p)<.1&&Math.abs(l+d)<.1&&Math.abs(a+c+m-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var f=(a+1)/2,y=(c+1)/2,g=(m+1)/2,x=(o+u)/4,v=(h+p)/4,b=(l+d)/4;return f>y&&f>g?f<.01?(i=0,r=.707106781,n=.707106781):(r=x/(i=Math.sqrt(f)),n=v/i):y>g?y<.01?(i=.707106781,r=0,n=.707106781):(i=x/(r=Math.sqrt(y)),n=b/r):g<.01?(i=.707106781,r=.707106781,n=0):(i=v/(n=Math.sqrt(g)),r=b/n),this.set(i,r,n,e),this}var w=Math.sqrt((d-l)*(d-l)+(h-p)*(h-p)+(u-o)*(u-o));return Math.abs(w)<.001&&(w=1),this.x=(d-l)/w,this.y=(h-p)/w,this.z=(u-o)/w,this.w=Math.acos((a+c+m-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}});var Vt=new a;function Ft(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function It(t,e,i){Ft.call(this,new Int8Array(t),e,i)}function Ct(t,e,i){Ft.call(this,new Uint8Array(t),e,i)}function Ut(t,e,i){Ft.call(this,new Uint8ClampedArray(t),e,i)}function Pt(t,e,i){Ft.call(this,new Int16Array(t),e,i)}function Lt(t,e,i){Ft.call(this,new Uint16Array(t),e,i)}function jt(t,e,i){Ft.call(this,new Int32Array(t),e,i)}function Ht(t,e,i){Ft.call(this,new Uint32Array(t),e,i)}function Dt(t,e,i){Ft.call(this,new Float32Array(t),e,i)}function qt(t,e,i){Ft.call(this,new Float64Array(t),e,i)}function Gt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.defineProperty(Ft.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ft.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[t+r]=e.array[i+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var s=t[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new St),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var s=t[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new o),e[i++]=s.x,e[i++]=s.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var s=t[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new a),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,r=0,n=t.length;r<n;r++){var s=t[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Bt),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this},applyMatrix3:function(t){for(var e=0,i=this.count;e<i;e++)Vt.x=this.getX(e),Vt.y=this.getY(e),Vt.z=this.getZ(e),Vt.applyMatrix3(t),this.setXYZ(e,Vt.x,Vt.y,Vt.z);return this},applyMatrix4:function(t){for(var e=0,i=this.count;e<i;e++)Vt.x=this.getX(e),Vt.y=this.getY(e),Vt.z=this.getZ(e),Vt.applyMatrix4(t),this.setXYZ(e,Vt.x,Vt.y,Vt.z);return this},applyNormalMatrix:function(t){for(var e=0,i=this.count;e<i;e++)Vt.x=this.getX(e),Vt.y=this.getY(e),Vt.z=this.getZ(e),Vt.applyNormalMatrix(t),this.setXYZ(e,Vt.x,Vt.y,Vt.z);return this},transformDirection:function(t){for(var e=0,i=this.count;e<i;e++)Vt.x=this.getX(e),Vt.y=this.getY(e),Vt.z=this.getZ(e),Vt.transformDirection(t),this.setXYZ(e,Vt.x,Vt.y,Vt.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this},setXYZW:function(t,e,i,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),It.prototype=Object.create(Ft.prototype),It.prototype.constructor=It,Ct.prototype=Object.create(Ft.prototype),Ct.prototype.constructor=Ct,Ut.prototype=Object.create(Ft.prototype),Ut.prototype.constructor=Ut,Pt.prototype=Object.create(Ft.prototype),Pt.prototype.constructor=Pt,Lt.prototype=Object.create(Ft.prototype),Lt.prototype.constructor=Lt,jt.prototype=Object.create(Ft.prototype),jt.prototype.constructor=jt,Ht.prototype=Object.create(Ft.prototype),Ht.prototype.constructor=Ht,Dt.prototype=Object.create(Ft.prototype),Dt.prototype.constructor=Dt,qt.prototype=Object.create(Ft.prototype),qt.prototype.constructor=qt,Object.assign(Gt.prototype,{computeGroups:function(t){for(var e,i=[],r=void 0,n=t.faces,s=0;s<n.length;s++){var a=n[s];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*s-e.start,i.push(e)),e={start:3*s,materialIndex:r})}void 0!==e&&(e.count=3*s-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,i=t.faces,r=t.vertices,n=t.faceVertexUvs,s=n[0]&&n[0].length>0,a=n[1]&&n[1].length>0,h=t.morphTargets,u=h.length;if(u>0){e=[];for(var c=0;c<u;c++)e[c]={name:h[c].name,data:[]};this.morphTargets.position=e}var l,p=t.morphNormals,d=p.length;if(d>0){l=[];for(c=0;c<d;c++)l[c]={name:p[c].name,data:[]};this.morphTargets.normal=l}var m=t.skinIndices,f=t.skinWeights,y=m.length===r.length,g=f.length===r.length;r.length>0&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(c=0;c<i.length;c++){var x=i[c];this.vertices.push(r[x.a],r[x.b],r[x.c]);var v=x.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{var b=x.normal;this.normals.push(b,b,b)}var w,M=x.vertexColors;if(3===M.length)this.colors.push(M[0],M[1],M[2]);else{var z=x.color;this.colors.push(z,z,z)}if(!0===s)void 0!==(w=n[0][c])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new o,new o,new o));if(!0===a)void 0!==(w=n[1][c])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new o,new o,new o));for(var T=0;T<u;T++){var S=h[T].vertices;e[T].data.push(S[x.a],S[x.b],S[x.c])}for(T=0;T<d;T++){var _=p[T].vertexNormals[c];l[T].data.push(_.a,_.b,_.c)}y&&this.skinIndices.push(m[x.a],m[x.b],m[x.c]),g&&this.skinWeights.push(f[x.a],f[x.b],f[x.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var Wt=1,Yt=new L,Xt=new at,Zt=new a,Jt=new w,Qt=new w,Kt=new a;function $t(){Object.defineProperty(this,"id",{value:Wt+=2}),this.uuid=i.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}$t.prototype=Object.assign(Object.create(j.prototype),{constructor:$t,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(function(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,r=t.length;i<r;++i)t[i]>e&&(e=t[i]);return e}(t)>65535?Ht:Lt)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var r=(new W).getNormalMatrix(t);i.applyNormalMatrix(r),i.needsUpdate=!0}var n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Yt.makeRotationX(t),this.applyMatrix4(Yt),this},rotateY:function(t){return Yt.makeRotationY(t),this.applyMatrix4(Yt),this},rotateZ:function(t){return Yt.makeRotationZ(t),this.applyMatrix4(Yt),this},translate:function(t,e,i){return Yt.makeTranslation(t,e,i),this.applyMatrix4(Yt),this},scale:function(t,e,i){return Yt.makeScale(t,e,i),this.applyMatrix4(Yt),this},lookAt:function(t){return Xt.lookAt(t),Xt.updateMatrix(),this.applyMatrix4(Xt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zt).negate(),this.translate(Zt.x,Zt.y,Zt.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var i=new Dt(3*e.vertices.length,3),r=new Dt(3*e.colors.length,3);if(this.setAttribute("position",i.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var n=new Dt(e.lineDistances.length,1);this.setAttribute("lineDistance",n.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],i=0,r=t.length;i<r;i++){var n=t[i];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Dt(e,3)),this},updateFromObject:function(t){var e,i=t.geometry;if(t.isMesh){var r=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(r=void 0,i.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(i);r.verticesNeedUpdate=i.verticesNeedUpdate,r.normalsNeedUpdate=i.normalsNeedUpdate,r.colorsNeedUpdate=i.colorsNeedUpdate,r.uvsNeedUpdate=i.uvsNeedUpdate,r.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=r}return!0===i.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(i.uvs),e.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Gt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Ft(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Ft(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new Ft(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var n=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Ft(n,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var s=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Ft(s,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var o=[],h=t.morphTargets[a],u=0,c=h.length;u<c;u++){var l=h[u],p=new Dt(3*l.data.length,3);p.name=l.name,o.push(p.copyVector3sArray(l.data))}this.morphAttributes[a]=o}if(t.skinIndices.length>0){var d=new Dt(4*t.skinIndices.length,4);this.setAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var m=new Dt(4*t.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new w);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var n=e[i];Jt.setFromBufferAttribute(n),this.morphTargetsRelative?(Kt.addVectors(this.boundingBox.min,Jt.min),this.boundingBox.expandByPoint(Kt),Kt.addVectors(this.boundingBox.max,Jt.max),this.boundingBox.expandByPoint(Kt)):(this.boundingBox.expandByPoint(Jt.min),this.boundingBox.expandByPoint(Jt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new T);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(Jt.setFromBufferAttribute(t),e)for(var r=0,n=e.length;r<n;r++){var s=e[r];Qt.setFromBufferAttribute(s),this.morphTargetsRelative?(Kt.addVectors(Jt.min,Qt.min),Jt.expandByPoint(Kt),Kt.addVectors(Jt.max,Qt.max),Jt.expandByPoint(Kt)):(Jt.expandByPoint(Qt.min),Jt.expandByPoint(Qt.max))}Jt.getCenter(i);var a=0;for(r=0,n=t.count;r<n;r++)Kt.fromBufferAttribute(t,r),a=Math.max(a,i.distanceToSquared(Kt));if(e)for(r=0,n=e.length;r<n;r++){s=e[r];for(var o=this.morphTargetsRelative,h=0,u=s.count;h<u;h++)Kt.fromBufferAttribute(s,h),o&&(Zt.fromBufferAttribute(t,h),Kt.add(Zt)),a=Math.max(a,i.distanceToSquared(Kt))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var i=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Ft(new Float32Array(i.length),3));else for(var r=e.normal.array,n=0,s=r.length;n<s;n++)r[n]=0;var o,h,u,c=e.normal.array,l=new a,p=new a,d=new a,m=new a,f=new a;if(t){var y=t.array;for(n=0,s=t.count;n<s;n+=3)o=3*y[n+0],h=3*y[n+1],u=3*y[n+2],l.fromArray(i,o),p.fromArray(i,h),d.fromArray(i,u),m.subVectors(d,p),f.subVectors(l,p),m.cross(f),c[o]+=m.x,c[o+1]+=m.y,c[o+2]+=m.z,c[h]+=m.x,c[h+1]+=m.y,c[h+2]+=m.z,c[u]+=m.x,c[u+1]+=m.y,c[u+2]+=m.z}else for(n=0,s=i.length;n<s;n+=9)l.fromArray(i,n),p.fromArray(i,n+3),d.fromArray(i,n+6),m.subVectors(d,p),f.subVectors(l,p),m.cross(f),c[n]=m.x,c[n+1]=m.y,c[n+2]=m.z,c[n+3]=m.x,c[n+4]=m.y,c[n+5]=m.z,c[n+6]=m.x,c[n+7]=m.y,c[n+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var r in i)if(void 0!==t.attributes[r])for(var n=i[r].array,s=t.attributes[r],a=s.array,o=s.itemSize*e,h=Math.min(a.length,n.length-o),u=0,c=o;u<h;u++,c++)n[c]=a[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,i=t.count;e<i;e++)Kt.x=t.getX(e),Kt.y=t.getY(e),Kt.z=t.getZ(e),Kt.normalize(),t.setXYZ(e,Kt.x,Kt.y,Kt.z)},toNonIndexed:function(){function t(t,e){for(var i=t.array,r=t.itemSize,n=new i.constructor(e.length*r),s=0,a=0,o=0,h=e.length;o<h;o++){s=e[o]*r;for(var u=0;u<r;u++)n[a++]=i[s++]}return new Ft(n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new $t,i=this.index.array,r=this.attributes;for(var n in r){var s=t(r[n],i);e.setAttribute(n,s)}var a=this.morphAttributes;for(n in a){for(var o=[],h=a[n],u=0,c=h.length;u<c;u++){s=t(h[u],i);o.push(s)}e.morphAttributes[n]=o}e.morphTargetsRelative=this.morphTargetsRelative;for(var l=this.groups,p=(u=0,l.length);u<p;u++){var d=l[u];e.addGroup(d.start,d.count,d.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var n=this.attributes;for(var i in n){var s=(p=n[i]).toJSON();""!==p.name&&(s.name=p.name),t.data.attributes[i]=s}var a={},o=!1;for(var i in this.morphAttributes){for(var h=this.morphAttributes[i],u=[],c=0,l=h.length;c<l;c++){var p;s=(p=h[c]).toJSON();""!==p.name&&(s.name=p.name),u.push(s)}u.length>0&&(a[i]=u,o=!0)}o&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);var d=this.groups;d.length>0&&(t.data.groups=JSON.parse(JSON.stringify(d)));var m=this.boundingSphere;return null!==m&&(t.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),t},clone:function(){return(new $t).copy(this)},copy:function(t){var e,i,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var n=t.index;null!==n&&this.setIndex(n.clone());var s=t.attributes;for(e in s){var a=s[e];this.setAttribute(e,a.clone())}var o=t.morphAttributes;for(e in o){var h=[],u=o[e];for(i=0,r=u.length;i<r;i++)h.push(u[i].clone());this.morphAttributes[e]=h}this.morphTargetsRelative=t.morphTargetsRelative;var c=t.groups;for(i=0,r=c.length;i<r;i++){var l=c[i];this.addGroup(l.start,l.count,l.materialIndex)}var p=t.boundingBox;null!==p&&(this.boundingBox=p.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var te=new L,ee=new k,ie=new T,re=new a,ne=new a,se=new a,ae=new a,oe=new a,he=new a,ue=new a,ce=new a,le=new a,pe=new o,de=new o,me=new o,fe=new a,ye=new a;function ge(t,e){at.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new $t,this.material=void 0!==e?e:new kt,this.updateMorphTargets()}function xe(t,e,i,r,n,s,a,o){if(null===(1===e.side?r.intersectTriangle(a,s,n,!0,o):r.intersectTriangle(n,s,a,2!==e.side,o)))return null;ye.copy(o),ye.applyMatrix4(t.matrixWorld);var h=i.ray.origin.distanceTo(ye);return h<i.near||h>i.far?null:{distance:h,point:ye.clone(),object:t}}function ve(t,e,i,r,n,s,a,h,u,c,l,p){re.fromBufferAttribute(n,c),ne.fromBufferAttribute(n,l),se.fromBufferAttribute(n,p);var d=t.morphTargetInfluences;if(e.morphTargets&&s&&d){ue.set(0,0,0),ce.set(0,0,0),le.set(0,0,0);for(var m=0,f=s.length;m<f;m++){var y=d[m],g=s[m];0!==y&&(ae.fromBufferAttribute(g,c),oe.fromBufferAttribute(g,l),he.fromBufferAttribute(g,p),a?(ue.addScaledVector(ae,y),ce.addScaledVector(oe,y),le.addScaledVector(he,y)):(ue.addScaledVector(ae.sub(re),y),ce.addScaledVector(oe.sub(ne),y),le.addScaledVector(he.sub(se),y)))}re.add(ue),ne.add(ce),se.add(le)}t.isSkinnedMesh&&(t.boneTransform(c,re),t.boneTransform(l,ne),t.boneTransform(p,se));var x=xe(t,e,i,r,re,ne,se,fe);if(x){h&&(pe.fromBufferAttribute(h,c),de.fromBufferAttribute(h,l),me.fromBufferAttribute(h,p),x.uv=wt.getUV(fe,re,ne,se,pe,de,me,new o)),u&&(pe.fromBufferAttribute(u,c),de.fromBufferAttribute(u,l),me.fromBufferAttribute(u,p),x.uv2=wt.getUV(fe,re,ne,se,pe,de,me,new o));var v=new Nt(c,l,p);wt.getNormal(re,ne,se,v.normal),x.face=v}return x}function be(t){Rt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function we(){at.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ge.prototype=Object.assign(Object.create(at.prototype),{constructor:ge,isMesh:!0,copy:function(t){return at.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,i,r=this.geometry;if(r.isBufferGeometry){var n=r.morphAttributes,s=Object.keys(n);if(s.length>0){var a=n[s[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)i=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var o=r.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){var i,r=this.geometry,n=this.material,s=this.matrixWorld;if(void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),ie.copy(r.boundingSphere),ie.applyMatrix4(s),!1!==t.ray.intersectsSphere(ie)&&(te.getInverse(s),ee.copy(t.ray).applyMatrix4(te),null===r.boundingBox||!1!==ee.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,h,u,c,l,p,d,m,f,y=r.index,g=r.attributes.position,x=r.morphAttributes.position,v=r.morphTargetsRelative,b=r.attributes.uv,w=r.attributes.uv2,M=r.groups,z=r.drawRange;if(null!==y)if(Array.isArray(n))for(c=0,p=M.length;c<p;c++)for(f=n[(m=M[c]).materialIndex],l=Math.max(m.start,z.start),d=Math.min(m.start+m.count,z.start+z.count);l<d;l+=3)a=y.getX(l),h=y.getX(l+1),u=y.getX(l+2),(i=ve(this,f,t,ee,g,x,v,b,w,a,h,u))&&(i.faceIndex=Math.floor(l/3),i.face.materialIndex=m.materialIndex,e.push(i));else for(c=Math.max(0,z.start),p=Math.min(y.count,z.start+z.count);c<p;c+=3)a=y.getX(c),h=y.getX(c+1),u=y.getX(c+2),(i=ve(this,n,t,ee,g,x,v,b,w,a,h,u))&&(i.faceIndex=Math.floor(c/3),e.push(i));else if(void 0!==g)if(Array.isArray(n))for(c=0,p=M.length;c<p;c++)for(f=n[(m=M[c]).materialIndex],l=Math.max(m.start,z.start),d=Math.min(m.start+m.count,z.start+z.count);l<d;l+=3)(i=ve(this,f,t,ee,g,x,v,b,w,a=l,h=l+1,u=l+2))&&(i.faceIndex=Math.floor(l/3),i.face.materialIndex=m.materialIndex,e.push(i));else for(c=Math.max(0,z.start),p=Math.min(g.count,z.start+z.count);c<p;c+=3)(i=ve(this,n,t,ee,g,x,v,b,w,a=c,h=c+1,u=c+2))&&(i.faceIndex=Math.floor(c/3),e.push(i))}else if(r.isGeometry){var T,S,_,A,E=Array.isArray(n),N=r.vertices,O=r.faces,R=r.faceVertexUvs[0];R.length>0&&(A=R);for(var k=0,B=O.length;k<B;k++){var V=O[k],F=E?n[V.materialIndex]:n;if(void 0!==F&&(T=N[V.a],S=N[V.b],_=N[V.c],i=xe(this,F,t,ee,T,S,_,fe))){if(A&&A[k]){var I=A[k];pe.copy(I[0]),de.copy(I[1]),me.copy(I[2]),i.uv=wt.getUV(fe,T,S,_,pe,de,me,new o)}i.face=V,i.faceIndex=k,e.push(i)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),be.prototype=Object.create(Rt.prototype),be.prototype.constructor=be,be.prototype.isMeshStandardMaterial=!0,be.prototype.copy=function(t){return Rt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},we.prototype=Object.assign(Object.create(at.prototype),{constructor:we,isScene:!0,copy:function(t,e){return at.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=at.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Me=new RegExp("[\\[\\]\\.:\\/]","g"),ze="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Te=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Se=/(WCOD+)?/.source.replace("WCOD",ze),_e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Ae=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Ee=new RegExp("^"+Te+Se+_e+Ae+"$"),Ne=["material","materials","bones"];function Oe(t,e,i){var r=i||Re.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Re(t,e,i){this.path=e,this.parsedPath=i||Re.parseTrackName(e),this.node=Re.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(Oe.prototype,{getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,r=this._bindings[i];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(Re,{Composite:Oe,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new Re.Composite(t,e,i):new Re(t,e,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Me,"")},parseTrackName:function(t){var e=Ee.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var n=i.nodeName.substring(r+1);-1!==Ne.indexOf(n)&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=n)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){var r=function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.name===e||n.uuid===e)return n;var s=r(n.children);if(s)return s}return null},n=r(t.children);if(n)return n}return null}}),Object.assign(Re.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)t[e++]=i[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++]},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,r=e.propertyName,n=e.propertyIndex;if(t||(t=Re.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var s=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===s){s=a;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==s){if(void 0===t[s])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[s]}}var o=t[r];if(void 0!==o){var h=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?h=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(h=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===n){n=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===n){n=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=n}else void 0!==o.fromArray&&void 0!==o.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][h]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Re.prototype,{_getValue_unbound:Re.prototype.getValue,_setValue_unbound:Re.prototype.setValue});var ke=0,Be=1,Ve=2,Fe=3,Ie=4,Ce=5121,Ue=5123,Pe=5126,Le=5125,je=34962,He=34963,De=9728,qe=9729,Ge=9984,We=9985,Ye=9986,Xe=9987,Ze=33071,Je=33648,Qe=10497,Ke={};Ke[1003]=De,Ke[1004]=Ge,Ke[1005]=Ye,Ke[1006]=qe,Ke[1007]=We,Ke[1008]=Xe,Ke[1001]=Ze,Ke[1e3]=Qe,Ke[1002]=Je;var $e,ti={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},ei=function(){};ei.prototype={constructor:ei,parse:function(t,e,r){var n={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forcePowerOfTwoTextures:!1,includeCustomExtensions:!1};(r=Object.assign({},n,r)).animations.length>0&&(r.trs=!0);var s,o={asset:{version:"2.0",generator:"GLTFExporter"}},h=0,u=[],c=[],l=new Map,p=[],d={},m={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},f=new Map,y=0;function g(t){return f.has(t)||f.set(t,y++),f.get(t)}function x(t,e){return t.length===e.length&&t.every((function(t,i){return t===e[i]}))}function v(t){return 4*Math.ceil(t/4)}function b(t,e){e=e||0;var i=v(t.byteLength);if(i!==t.byteLength){var r=new Uint8Array(i);if(r.set(new Uint8Array(t)),0!==e)for(var n=t.byteLength;n<i;n++)r[n]=e;return r.buffer}return t}function w(t,e){if(0!==Object.keys(t.userData).length)try{var i=JSON.parse(JSON.stringify(t.userData));if(r.includeCustomExtensions&&i.gltfExtensions){for(var n in void 0===e.extensions&&(e.extensions={}),i.gltfExtensions)e.extensions[n]=i.gltfExtensions[n],d[n]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(e.extras=i)}catch(e){console.warn("THREE.GLTFExporter: userData of '"+t.name+"' won't be serialized because of JSON.stringify error - "+e.message)}}function M(t,e){var i=!1,r={};0===e.offset.x&&0===e.offset.y||(r.offset=e.offset.toArray(),i=!0),0!==e.rotation&&(r.rotation=e.rotation,i=!0),1===e.repeat.x&&1===e.repeat.y||(r.scale=e.repeat.toArray(),i=!0),i&&(t.extensions=t.extensions||{},t.extensions.KHR_texture_transform=r,d.KHR_texture_transform=!0)}function z(t){return o.buffers||(o.buffers=[{byteLength:0}]),u.push(t),0}function T(t){return o.bufferViews||(o.bufferViews=[]),new Promise((function(e){var i=new FileReader;i.readAsArrayBuffer(t),i.onloadend=function(){var t=b(i.result),r={buffer:z(t),byteOffset:h,byteLength:t.byteLength};h+=t.byteLength,o.bufferViews.push(r),e(o.bufferViews.length-1)}}))}function S(t,e,i,n){var s;if(t.array.constructor===Float32Array)s=Pe;else if(t.array.constructor===Uint32Array)s=Le;else if(t.array.constructor===Uint16Array)s=Ue;else{if(t.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");s=Ce}if(void 0===i&&(i=0),void 0===n&&(n=t.count),r.truncateDrawRange&&void 0!==e&&null===e.index){var a=i+n,u=e.drawRange.count===1/0?t.count:e.drawRange.start+e.drawRange.count;i=Math.max(i,e.drawRange.start),(n=Math.min(a,u)-i)<0&&(n=0)}if(0===n)return null;var c,l=function(t,e,i){for(var r={min:new Array(t.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(t.itemSize).fill(Number.NEGATIVE_INFINITY)},n=e;n<e+i;n++)for(var s=0;s<t.itemSize;s++){var a=t.array[n*t.itemSize+s];r.min[s]=Math.min(r.min[s],a),r.max[s]=Math.max(r.max[s],a)}return r}(t,i,n);void 0!==e&&(c=t===e.index?He:je);var p=function(t,e,i,r,n){var s;o.bufferViews||(o.bufferViews=[]),s=e===Ce?1:e===Ue?2:4;for(var a=v(r*t.itemSize*s),u=new DataView(new ArrayBuffer(a)),c=0,l=i;l<i+r;l++)for(var p=0;p<t.itemSize;p++){var d=t.array[l*t.itemSize+p];e===Pe?u.setFloat32(c,d,!0):e===Le?u.setUint32(c,d,!0):e===Ue?u.setUint16(c,d,!0):e===Ce&&u.setUint8(c,d),c+=s}var m={buffer:z(u.buffer),byteOffset:h,byteLength:a};return void 0!==n&&(m.target=n),n===je&&(m.byteStride=t.itemSize*s),h+=a,o.bufferViews.push(m),{id:o.bufferViews.length-1,byteLength:0}}(t,s,i,n,c),d={bufferView:p.id,byteOffset:p.byteOffset,componentType:s,count:n,max:l.max,min:l.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[t.itemSize]};return!0===t.normalized&&(d.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(d),o.accessors.length-1}function _(t,e,n){m.images.has(t)||m.images.set(t,{});var a=m.images.get(t),h=1023===e?"image/png":"image/jpeg",u=h+":flipY/"+n.toString();if(void 0!==a[u])return a[u];o.images||(o.images=[]);var l={mimeType:h};if(r.embedImages)if("string"==typeof t&&"data:image"===t.substring(0,10))if(!0===r.binary){var p=atob(t.split(",")[1]),d=new Blob([p],{type:h});c.push(T(d).then((function(t){l.bufferView=t})))}else l.uri=t;else{var f=s=s||document.createElement("canvas");f.width=Math.min(t.width,r.maxTextureSize),f.height=Math.min(t.height,r.maxTextureSize),r.forcePowerOfTwoTextures&&!function(t){return i.isPowerOfTwo(t.width)&&i.isPowerOfTwo(t.height)}(f)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",t),f.width=i.floorPowerOfTwo(f.width),f.height=i.floorPowerOfTwo(f.height));var y=f.getContext("2d");!0===n&&(y.translate(0,f.height),y.scale(1,-1),!0===r.binary?c.push(new Promise((function(t){f.toBlob((function(e){T(e).then((function(e){l.bufferView=e,t()}))}),h)}))):l.uri=f.toDataURL(h)),y.drawImage(t,0,0,f.width,f.height),!0===r.binary?c.push(new Promise((function(t){f.toBlob((function(e){T(e).then((function(e){l.bufferView=e,t()}))}),h)}))):l.uri=f.toDataURL(h)}else l.uri=t.src;o.images.push(l);var g=o.images.length-1;return a[u]=g,g}function A(t){o.samplers||(o.samplers=[]);var e={magFilter:Ke[t.magFilter],minFilter:Ke[t.minFilter],wrapS:Ke[t.wrapS],wrapT:Ke[t.wrapT]};return o.samplers.push(e),o.samplers.length-1}function E(t){if(m.textures.has(t))return m.textures.get(t);o.textures||(o.textures=[]);var e={sampler:A(t),source:_(t.image,t.format,t.flipY)};t.name&&(e.name=t.name),o.textures.push(e);var i=o.textures.length-1;return m.textures.set(t,i),i}function N(t){if(m.materials.has(t))return m.materials.get(t);if(t.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;o.materials||(o.materials=[]);var e={pbrMetallicRoughness:{}};t.isMeshBasicMaterial?(e.extensions={KHR_materials_unlit:{}},d.KHR_materials_unlit=!0):t.isGLTFSpecularGlossinessMaterial?(e.extensions={KHR_materials_pbrSpecularGlossiness:{}},d.KHR_materials_pbrSpecularGlossiness=!0):t.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var i=t.color.toArray().concat([t.opacity]);if(x(i,[1,1,1,1])||(e.pbrMetallicRoughness.baseColorFactor=i),t.isMeshStandardMaterial?(e.pbrMetallicRoughness.metallicFactor=t.metalness,e.pbrMetallicRoughness.roughnessFactor=t.roughness):t.isMeshBasicMaterial?(e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9):(e.pbrMetallicRoughness.metallicFactor=.5,e.pbrMetallicRoughness.roughnessFactor=.5),t.isGLTFSpecularGlossinessMaterial){e.pbrMetallicRoughness.baseColorFactor&&(e.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=e.pbrMetallicRoughness.baseColorFactor);var r=[1,1,1];t.specular.toArray(r,0),e.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=r,e.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=t.glossiness}if(t.metalnessMap||t.roughnessMap)if(t.metalnessMap===t.roughnessMap){var n={index:E(t.metalnessMap)};M(n,t.metalnessMap),e.pbrMetallicRoughness.metallicRoughnessTexture=n}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(t.map){var s={index:E(t.map)};M(s,t.map),t.isGLTFSpecularGlossinessMaterial&&(e.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=s),e.pbrMetallicRoughness.baseColorTexture=s}if(t.isGLTFSpecularGlossinessMaterial&&t.specularMap){var a={index:E(t.specularMap)};M(a,t.specularMap),e.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=a}if(t.emissive){var h=t.emissive.clone().multiplyScalar(t.emissiveIntensity).toArray();if(x(h,[0,0,0])||(e.emissiveFactor=h),t.emissiveMap){var u={index:E(t.emissiveMap)};M(u,t.emissiveMap),e.emissiveTexture=u}}if(t.normalMap){var c={index:E(t.normalMap)};t.normalScale&&-1!==t.normalScale.x&&(t.normalScale.x!==t.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),c.scale=t.normalScale.x),M(c,t.normalMap),e.normalTexture=c}if(t.aoMap){var l={index:E(t.aoMap),texCoord:1};1!==t.aoMapIntensity&&(l.strength=t.aoMapIntensity),M(l,t.aoMap),e.occlusionTexture=l}t.transparent?e.alphaMode="BLEND":t.alphaTest>0&&(e.alphaMode="MASK",e.alphaCutoff=t.alphaTest),2===t.side&&(e.doubleSided=!0),""!==t.name&&(e.name=t.name),w(t,e),o.materials.push(e);var p=o.materials.length-1;return m.materials.set(t,p),p}function O(t){var e=[t.geometry.uuid];if(Array.isArray(t.material))for(var i=0,r=t.material.length;i<r;i++)e.push(t.material[i].uuid);else e.push(t.material.uuid);var n=e.join(":");if(m.meshes.has(n))return m.meshes.get(n);var s,h=t.geometry;s=t.isLineSegments?Be:t.isLineLoop?Ve:t.isLine?Fe:t.isPoints?ke:t.material.wireframe?Be:Ie,h.isBufferGeometry||(console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead."),h=(new $t).setFromObject(t));var u={},c={},l=[],p=[],d={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},f=h.getAttribute("normal");void 0===f||function(t){if(m.attributesNormalized.has(t))return!1;for(var e=new a,i=0,r=t.count;i<r;i++)if(Math.abs(e.fromArray(t.array,3*i).length()-1)>5e-4)return!1;return!0}(f)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),h.setAttribute("normal",function(t){if(m.attributesNormalized.has(t))return m.attributesNormalized.get(t);for(var e=t.clone(),i=new a,r=0,n=e.count;r<n;r++)i.fromArray(e.array,3*r),0===i.x&&0===i.y&&0===i.z?i.setX(1):i.normalize(),i.toArray(e.array,3*r);return m.attributesNormalized.set(t,e),e}(f)));var y=null;for(var x in h.attributes)if("morph"!==x.substr(0,5)){var v=h.attributes[x];x=d[x]||x.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(x)||(x="_"+x),m.attributes.has(g(v)))c[x]=m.attributes.get(g(v));else{y=null;var b=v.array;"JOINTS_0"!==x||b instanceof Uint16Array||b instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),y=new Ft(new Uint16Array(b),v.itemSize,v.normalized));var M=S(y||v,h);null!==M&&(c[x]=M,m.attributes.set(g(v),M))}}if(void 0!==f&&h.setAttribute("normal",f),0===Object.keys(c).length)return null;if(void 0!==t.morphTargetInfluences&&t.morphTargetInfluences.length>0){var z=[],T=[],_={};if(void 0!==t.morphTargetDictionary)for(var A in t.morphTargetDictionary)_[t.morphTargetDictionary[A]]=A;for(i=0;i<t.morphTargetInfluences.length;++i){var E={},O=!1;for(var x in h.morphAttributes)if("position"===x||"normal"===x){v=h.morphAttributes[x][i];var R=x.toUpperCase(),k=h.attributes[x];if(m.attributes.has(g(v)))E[R]=m.attributes.get(g(v));else{var B=v.clone();if(!h.morphTargetsRelative)for(var V=0,F=v.count;V<F;V++)B.setXYZ(V,v.getX(V)-k.getX(V),v.getY(V)-k.getY(V),v.getZ(V)-k.getZ(V));E[R]=S(B,h),m.attributes.set(g(k),E[R])}}else O||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),O=!0);p.push(E),z.push(t.morphTargetInfluences[i]),void 0!==t.morphTargetDictionary&&T.push(_[i])}u.weights=z,T.length>0&&(u.extras={},u.extras.targetNames=T)}var I=Array.isArray(t.material);if(I&&0===h.groups.length)return null;for(var C=I?t.material:[t.material],U=I?h.groups:[{materialIndex:0,start:void 0,count:void 0}],P=(i=0,U.length);i<P;i++){var L={mode:s,attributes:c};if(w(h,L),p.length>0&&(L.targets=p),null!==h.index){var j=g(h.index);void 0===U[i].start&&void 0===U[i].count||(j+=":"+U[i].start+":"+U[i].count),m.attributes.has(j)?L.indices=m.attributes.get(j):(L.indices=S(h.index,h,U[i].start,U[i].count),m.attributes.set(j,L.indices)),null===L.indices&&delete L.indices}var H=N(C[U[i].materialIndex]);null!==H&&(L.material=H),l.push(L)}u.primitives=l,o.meshes||(o.meshes=[]),o.meshes.push(u);var D=o.meshes.length-1;return m.meshes.set(n,D),D}function R(t,e){o.animations||(o.animations=[]);for(var i=(t=ei.Utils.mergeMorphTargetTracks(t.clone(),e)).tracks,r=[],n=[],s=0;s<i.length;++s){var a=i[s],h=Re.parseTrackName(a.name),u=Re.findNode(e,h.nodeName),c=ti[h.propertyName];if("bones"===h.objectName&&(u=!0===u.isSkinnedMesh?u.skeleton.getBoneByName(h.objectIndex):void 0),!u||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',a.name),null;var p,d=a.values.length/a.times.length;c===ti.morphTargetInfluences&&(d/=u.morphTargetInfluences.length),!0===a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(p="CUBICSPLINE",d/=3):p=2300===a.getInterpolation()?"STEP":"LINEAR",n.push({input:S(new Ft(a.times,1)),output:S(new Ft(a.values,d)),interpolation:p}),r.push({sampler:n.length-1,target:{node:l.get(u),path:c}})}return o.animations.push({name:t.name||"clip_"+o.animations.length,samplers:n,channels:r}),o.animations.length-1}function k(t){var e=o.nodes[l.get(t)],i=t.skeleton;if(void 0===i)return null;var r=t.skeleton.bones[0];if(void 0===r)return null;for(var n=[],s=new Float32Array(16*i.bones.length),a=0;a<i.bones.length;++a)n.push(l.get(i.bones[a])),i.boneInverses[a].toArray(s,16*a);return void 0===o.skins&&(o.skins=[]),o.skins.push({inverseBindMatrices:S(new Ft(s,16)),joints:n,skeleton:l.get(r)}),e.skin=o.skins.length-1}function B(t){var e={};t.name&&(e.name=t.name),e.color=t.color.toArray(),e.intensity=t.intensity,t.isDirectionalLight?e.type="directional":t.isPointLight?(e.type="point",t.distance>0&&(e.range=t.distance)):t.isSpotLight&&(e.type="spot",t.distance>0&&(e.range=t.distance),e.spot={},e.spot.innerConeAngle=(t.penumbra-1)*t.angle*-1,e.spot.outerConeAngle=t.angle),void 0!==t.decay&&2!==t.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!t.target||t.target.parent===t&&0===t.target.position.x&&0===t.target.position.y&&-1===t.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var i=o.extensions.KHR_lights_punctual.lights;return i.push(e),i.length-1}function V(t){o.nodes||(o.nodes=[]);var e={};if(r.trs){var n=t.quaternion.toArray(),s=t.position.toArray(),a=t.scale.toArray();x(n,[0,0,0,1])||(e.rotation=n),x(s,[0,0,0])||(e.translation=s),x(a,[1,1,1])||(e.scale=a)}else t.matrixAutoUpdate&&t.updateMatrix(),x(t.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(e.matrix=t.matrix.elements);if(""!==t.name&&(e.name=String(t.name)),w(t,e),t.isMesh||t.isLine||t.isPoints){var h=O(t);null!==h&&(e.mesh=h)}else if(t.isCamera)e.camera=function(t){o.cameras||(o.cameras=[]);var e=t.isOrthographicCamera,r={type:e?"orthographic":"perspective"};return e?r.orthographic={xmag:2*t.right,ymag:2*t.top,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:r.perspective={aspectRatio:t.aspect,yfov:i.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},""!==t.name&&(r.name=t.type),o.cameras.push(r),o.cameras.length-1}(t);else if(t.isDirectionalLight||t.isPointLight||t.isSpotLight)d.KHR_lights_punctual||(o.extensions=o.extensions||{},o.extensions.KHR_lights_punctual={lights:[]},d.KHR_lights_punctual=!0),e.extensions=e.extensions||{},e.extensions.KHR_lights_punctual={light:B(t)};else if(t.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",t),null;if(t.isSkinnedMesh&&p.push(t),t.children.length>0){for(var u=[],c=0,m=t.children.length;c<m;c++){var f=t.children[c];if(f.visible||!1===r.onlyVisible){var y=V(f);null!==y&&u.push(y)}}u.length>0&&(e.children=u)}o.nodes.push(e);var g=o.nodes.length-1;return l.set(t,g),g}function F(t){o.scenes||(o.scenes=[],o.scene=0);var e={};""!==t.name&&(e.name=t.name),o.scenes.push(e);for(var i=[],n=0,s=t.children.length;n<s;n++){var a=t.children[n];if(a.visible||!1===r.onlyVisible){var h=V(a);null!==h&&i.push(h)}}i.length>0&&(e.nodes=i),w(t,e)}!function(t){t=t instanceof Array?t:[t];for(var e=[],i=0;i<t.length;i++)t[i]instanceof we?F(t[i]):e.push(t[i]);for(e.length>0&&function(t){var e=new we;e.name="AuxScene";for(var i=0;i<t.length;i++)e.children.push(t[i]);F(e)}(e),i=0;i<p.length;++i)k(p[i]);for(i=0;i<r.animations.length;++i)R(r.animations[i],t[0])}(t),Promise.all(c).then((function(){var t=new Blob(u,{type:"application/octet-stream"}),i=Object.keys(d);if(i.length>0&&(o.extensionsUsed=i),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=t.size),!0===r.binary){(n=new FileReader).readAsArrayBuffer(t),n.onloadend=function(){var t=b(n.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,t.byteLength,!0),i.setUint32(4,5130562,!0);var r=b(function(t){if(void 0!==TextEncoder)return(new TextEncoder).encode(t).buffer;for(var e=new Uint8Array(new ArrayBuffer(t.length)),i=0,r=t.length;i<r;i++){var n=t.charCodeAt(i);e[i]=n>255?32:n}return e.buffer}(JSON.stringify(o)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,r.byteLength,!0),s.setUint32(4,1313821514,!0);var a=new ArrayBuffer(12),h=new DataView(a);h.setUint32(0,1179937895,!0),h.setUint32(4,2,!0);var u=12+s.byteLength+r.byteLength+i.byteLength+t.byteLength;h.setUint32(8,u,!0);var c=new Blob([a,s,r,i,t],{type:"application/octet-stream"}),l=new FileReader;l.readAsArrayBuffer(c),l.onloadend=function(){e(l.result)}}}else{var n;if(o.buffers&&o.buffers.length>0)(n=new FileReader).readAsDataURL(t),n.onloadend=function(){var t=n.result;o.buffers[0].uri=t,e(o)};else e(o)}}))}},ei.Utils={insertKeyframe:function(t,e){var i,r=t.getValueSize(),n=new t.TimeBufferType(t.times.length+1),s=new t.ValueBufferType(t.values.length+r),a=t.createInterpolant(new t.ValueBufferType(r));if(0===t.times.length){n[0]=e;for(var o=0;o<r;o++)s[o]=0;i=0}else if(e<t.times[0]){if(Math.abs(t.times[0]-e)<.001)return 0;n[0]=e,n.set(t.times,1),s.set(a.evaluate(e),0),s.set(t.values,r),i=0}else if(e>t.times[t.times.length-1]){if(Math.abs(t.times[t.times.length-1]-e)<.001)return t.times.length-1;n[n.length-1]=e,n.set(t.times,0),s.set(t.values,0),s.set(a.evaluate(e),t.values.length),i=n.length-1}else for(o=0;o<t.times.length;o++){if(Math.abs(t.times[o]-e)<.001)return o;if(t.times[o]<e&&t.times[o+1]>e){n.set(t.times.slice(0,o+1),0),n[o+1]=e,n.set(t.times.slice(o+1),o+2),s.set(t.values.slice(0,(o+1)*r),0),s.set(a.evaluate(e),(o+1)*r),s.set(t.values.slice((o+1)*r),(o+2)*r),i=o+1;break}}return t.times=n,t.values=s,i},mergeMorphTargetTracks:function(t,e){for(var i=[],r={},n=t.tracks,s=0;s<n.length;++s){var a=n[s],o=Re.parseTrackName(a.name),h=Re.findNode(e,o.nodeName);if("morphTargetInfluences"===o.propertyName&&void 0!==o.propertyIndex){if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(a=a.clone()).setInterpolation(2301)}var u,c=h.morphTargetInfluences.length,l=h.morphTargetDictionary[o.propertyIndex];if(void 0===l)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);if(void 0!==r[h.uuid]){var p=a.createInterpolant(new a.ValueBufferType(1));u=r[h.uuid];for(f=0;f<u.times.length;f++)u.values[f*c+l]=p.evaluate(u.times[f]);for(f=0;f<a.times.length;f++){var d=this.insertKeyframe(u,a.times[f]);u.values[d*c+l]=a.values[f]}}else{for(var m=new((u=a.clone()).ValueBufferType)(c*u.times.length),f=0;f<u.times.length;f++)m[f*c+l]=u.values[f];u.name=o.nodeName+".morphTargetInfluences",u.values=m,r[h.uuid]=u,i.push(u)}}else i.push(a)}return t.tracks=i,t}};var ii=function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===$e&&($e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$e.width=t.width,$e.height=t.height;var i=$e.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=$e}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")},ri=0;function ni(t,e,r,n,s,a,h,u,c,l){Object.defineProperty(this,"id",{value:ri++}),this.uuid=i.generateUUID(),this.name="",this.image=void 0!==t?t:ni.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:ni.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==s?s:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==c?c:1,this.format=void 0!==h?h:1023,this.internalFormat=null,this.type=void 0!==u?u:1009,this.offset=new o(0,0),this.repeat=new o(1,1),this.center=new o(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new W,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:3e3,this.version=0,this.onUpdate=null}function si(t){Rt.call(this),this.type="LineBasicMaterial",this.color=new St(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}ni.DEFAULT_IMAGE=void 0,ni.DEFAULT_MAPPING=300,ni.prototype=Object.assign(Object.create(j.prototype),{constructor:ni,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=i.generateUUID()),!e&&void 0===t.images[n.uuid]){var s;if(Array.isArray(n)){s=[];for(var a=0,o=n.length;a<o;a++)s.push(ii(n[a]))}else s=ii(n);t.images[n.uuid]={uuid:n.uuid,url:s}}r.image=n.uuid}return e||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(ni.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),si.prototype=Object.create(Rt.prototype),si.prototype.constructor=si,si.prototype.isLineBasicMaterial=!0,si.prototype.copy=function(t){return Rt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var ai=new a,oi=new a,hi=new L,ui=new k,ci=new T;function li(t,e,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),at.call(this),this.type="Line",this.geometry=void 0!==t?t:new $t,this.material=void 0!==e?e:new si}li.prototype=Object.assign(Object.create(at.prototype),{constructor:li,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[0],r=1,n=e.count;r<n;r++)ai.fromBufferAttribute(e,r-1),oi.fromBufferAttribute(e,r),i[r]=i[r-1],i[r]+=ai.distanceTo(oi);t.setAttribute("lineDistance",new Dt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var s=t.vertices;(i=t.lineDistances)[0]=0;for(r=1,n=s.length;r<n;r++)i[r]=i[r-1],i[r]+=s[r-1].distanceTo(s[r])}return this},raycast:function(t,e){var i=this.geometry,r=this.matrixWorld,n=t.params.Line.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),ci.copy(i.boundingSphere),ci.applyMatrix4(r),ci.radius+=n,!1!==t.ray.intersectsSphere(ci)){hi.getInverse(r),ui.copy(t.ray).applyMatrix4(hi);var s=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,h=new a,u=new a,c=new a,l=new a,p=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var d=i.index,m=i.attributes.position.array;if(null!==d)for(var f=d.array,y=0,g=f.length-1;y<g;y+=p){var x=f[y],v=f[y+1];if(h.fromArray(m,3*x),u.fromArray(m,3*v),!(ui.distanceSqToSegment(h,u,l,c)>o))l.applyMatrix4(this.matrixWorld),(M=t.ray.origin.distanceTo(l))<t.near||M>t.far||e.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,g=m.length/3-1;y<g;y+=p){if(h.fromArray(m,3*y),u.fromArray(m,3*y+3),!(ui.distanceSqToSegment(h,u,l,c)>o))l.applyMatrix4(this.matrixWorld),(M=t.ray.origin.distanceTo(l))<t.near||M>t.far||e.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(i.isGeometry){var b=i.vertices,w=b.length;for(y=0;y<w-1;y+=p){var M;if(!(ui.distanceSqToSegment(b[y],b[y+1],l,c)>o))l.applyMatrix4(this.matrixWorld),(M=t.ray.origin.distanceTo(l))<t.near||M>t.far||e.push({distance:M,point:c.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var pi=new a,di=new a;function mi(t,e){li.call(this,t,e),this.type="LineSegments"}mi.prototype=Object.assign(Object.create(li.prototype),{constructor:mi,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,i=[],r=0,n=e.count;r<n;r+=2)pi.fromBufferAttribute(e,r),di.fromBufferAttribute(e,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+pi.distanceTo(di);t.setAttribute("lineDistance",new Dt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var s=t.vertices;for(i=t.lineDistances,r=0,n=s.length;r<n;r+=2)pi.copy(s[r]),di.copy(s[r+1]),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+pi.distanceTo(di)}return this}}),onmessage=function(t){const e=t.data,i=e.options,r=new we;e.items.forEach((function(t){r.add(function(t,e){switch(t.type){case"walls":return function(t,e){const i=new $t;i.setIndex(t.index),i.setAttribute("position",t.position);const r=t.position.array,n=r.length/3,s=new Dt(2*n,2),a=s.array,o=t.modelLimits.max.z,h=2*o;var u;for(u=0;u<n;u++){let t=2*u,e=(r[3*u+2]+o)/h;a[t]=e,a[t+1]=e}i.setAttribute("uv",s);const c=new be({map:new ni("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAACCAYAAAA5Ht7JAAAAd0lEQVQY08XBzQ7BQBSA0e9Of1SElWCKxNLWK3sgG2IjKqlm0i6tLGZur8dwjpylscaVXCznlU15LEtilSOTDJmDrEHqEfEfZBNw9Z3KX5n5G4vVk0Px5YRyRNkn2PbGbhCKEKFL0Cm0Ed4JWoWgEEcAxAzHn/0AK3IoAmtWeUsAAAAASUVORK5CYII=")});e.rotate&&fi(r);return new ge(i,c)}(t,e);case"lines":return function(t,e){const i=new $t;i.setIndex(t.index),i.setAttribute("position",t.position);const r=new be;e.rotate&&fi(t.position.array);return new mi(i,r)}(t,e);default:console.error("unknown item type",t.type," requested")}}(t,i))}));(new ei).parse(r,(function(t){if(i.binary)postMessage({status:"ok",gltf:t},[t]);else{var e=JSON.stringify(t,null,2);postMessage({status:"ok",gltf:e})}}),{binary:i.binary})};function fi(t){const e=t.length;var i;for(i=0;i<e;i++){let e=3*i,r=t[e+2];t[e+2]=-t[e+1],t[e+1]=r}}}));
